library(data.table)
library(foreach)
library(doParallel)
setwd("/mnt/external/Condensed Graph Model/Version 5.3/Replication Analysis 3/Original Dataset/Muscle_Skeletal_recount")
in_file <- paste('Muscle_Skeletal_recount normalized.csv', sep = ',')
cov_file <- paste('covariates.csv', sep = '')
in_file <- paste('Muscle_Skeletal_recount normalized.csv', sep = '')
in_file <- paste0('Muscle_Skeletal_recount normalized.csv')
cov_file <- paste0('covariates.csv')
gene_file <- paste0('genes.csv')
cores <- 5
in_file <- 'Muscle_Skeletal_recount normalized.csv'
cov_file <- 'covariates.csv'
gene_file <- 'genes.csv'
out_file <- 'Muscle_Skeletal_recount.csv'
df <- read.csv(in_file)
View(df)
?read.csv
library(data.table)
library(foreach)
library(doParallel)
# ==================================================
# INPUT DATA
cores <- 5
in_file <- 'Muscle_Skeletal_recount normalized.csv'
cov_file <- 'covariates.csv'
gene_file <- 'genes.csv'
out_file <- 'Muscle_Skeletal_recount.csv'
# # ==================================================
df <- read.csv(in_file)
cov_data <- read.table(cov_file,header = TRUE)
View(cov_data)
cov_data <- read.table(cov_file,header = TRUE,sep = ',')
View(cov_data)
View(df)
View(cov_data)
df_new <- df[,-1]
View(df_new)
rm(list=ls())
source("/mnt/external/Condensed Graph Model/Version 5.3/Replication Analysis 3/Original Dataset/Muscle_Skeletal_recount/covariates.R")
source("/mnt/external/Condensed Graph Model/Version 5.3/Replication Analysis 3/Original Dataset/Muscle_Skeletal_recount/covariates.R")
x = df[i, -1])
x = df[i, -1]
x <- df[1, -1]
df <- read.csv(in_file)
x
df <- read.csv(in_file)
df[i, ])
df[i, ]
df[1, ]
df[1, -1]
df[i, -1]
df[1,-1]
rm(list = ls())
library(data.table)
library(foreach)
library(doParallel)
cores <- 5
in_file <- 'Muscle_Skeletal_recount normalized.csv'
cov_file <- 'covariates.csv'
gene_file <- 'genes.csv'
out_file <- 'Muscle_Skeletal_recount.csv'
df <- read.csv(in_file)
cov_data <- read.csv(cov_file,header = TRUE)
cluster <- makeCluster(cores)
registerDoParallel(cluster)
df_adjusted <- foreach(i = 1:nrow(df), .combine = 'rbind') %dopar% {
lm_model <- lm( as.numeric(df[i, -1]) ~ t(cov_data[,-1]))
residuals(lm_model)
}
setwd("/mnt/external/Condensed Graph Model/Version 5.3/Replication Analysis 3/Original Dataset/Muscle_Skeletal_recount")
cluster <- makeCluster(cores)
registerDoParallel(cluster)
df_adjusted <- foreach(i = 1:nrow(df), .combine = 'rbind') %dopar% {
lm_model <- lm( as.numeric(df[i, -1]) ~ t(cov_data[,-1]))
residuals(lm_model)
}
cov_data[,-1]
t(cov_data[,-1])
as.numeric(df[i, -1])
i = 1
as.numeric(df[i, -1])
t(cov_data[,-1])
as.numeric(df[i, -1]) ~ t(cov_data[,-1])
lm( as.numeric(df[i, -1]) ~ t(cov_data[,-1]))
as.numeric(df[i, -1])
t(cov_data[,-1])
as.numeric(t(cov_data[,-1])
)
t(as.numeric(cov_data[,-1]))
t(cov_data)
t(cov_data)[,-1]
cov_data
t(cov_data)[-1,]
lm_model <- lm( as.numeric(df[i, -1]) ~ as.data.frame(t(cov_data)[-1,]))
as.numeric(t(cov_data)[-1,])
cov_new <- as.data.frame(t(cov_data))
View(cov_new)
lm_model <- lm( as.numeric(df[i, -1]) ~ cov_new[-1,])
as.numeric(df[i, -1])
cov_new[-1,]
cov_data[,-1]
t(cov_data[,-1])
typeof(t(cov_data[,-1]))
class(t(cov_data[,-1]))
data.frame(t(cov_data[,-1]))
as.data.frame(t(cov_data[,-1]))
class(as.data.frame(t(cov_data[,-1])))
class(data.frame(t(cov_data[,-1])))
lm_model <- lm( as.numeric(df[i, -1]) ~ data.frame(t(cov_data[,-1])))
lm_model <- lm( as.numeric(df[i, -1]) ~ data.frame(t(cov_data[1,-1])))
lm_model <- lm( as.numeric(df[i, -1]) ~ data.frame(t(cov_data[2,-1])))
cov_new <- data.frame(t(cov_data[,-1]))
View(cov_new)
lm_model <- lm( as.numeric(df[i, -1]) ~ cov_new[1,] + cov_new[2,])
cov_new[1,]
lm_model <- lm( as.numeric(df[i, -1]) ~ as.numeric(cov_new[1,]))
lm_model <- lm( as.numeric(df[i, -1]) ~ as.numeric(cov_new))
View(cov_new)
lm_model <- lm( as.numeric(df[i, -1]) ~ as.numeric(cov_new[1,]) + as.numeric(cov_new[2,]))
df <- read.csv(in_file)
cov_data <- read.csv(cov_file,header = TRUE)
cluster <- makeCluster(cores)
registerDoParallel(cluster)
df_adjusted <- foreach(i = 1:nrow(df), .combine = 'rbind') %dopar% {
lm_model <- lm( as.numeric(df[i, -1]) ~ as.numeric(cov_new[1,]) + as.numeric(cov_new[2,]))
residuals(lm_model)
}
df <- read.csv(in_file)
cov_data <- read.csv(cov_file,header = TRUE)
cluster <- makeCluster(cores)
registerDoParallel(cluster)
df_adjusted <- foreach(i = 1:nrow(df), .combine = 'rbind') %dopar% {
lm_model <- lm( as.numeric(df[i, -1]) ~ t(cov_data))
residuals(lm_model)
}
library(data.table)
library(foreach)
library(doParallel)
rm(list = ls())
library(data.table)
library(foreach)
library(doParallel)
tissue = 'Lung'
in_file <- paste('Gene Expression Matrices/', tissue, '.v8.normalized_expression.bed.gz', sep = '')
cov_file <- paste('Covariates/', tissue, '.v8.covariates.txt', sep = '')
gene_file <- paste('Genes/', tissue, '.v8.egenes.txt.gz', sep = '')
dir_path <- paste('Preprocessed Files/', tissue, '/', sep = "")
if (!dir.exists(dir_path)) {
dir.create(dir_path, recursive = TRUE)
}
out_file <- paste(dir_path, tissue, '.csv', sep = '')
outg_file <- paste(dir_path, 'genes.csv', sep = '')
outr_file <- paste(dir_path, tissue, '_orig_filtered.csv', sep = '')
# Extract Protein-Coding Genes
print('Extracting Protein-Coding Genes')
gencode <- rtracklayer::import("gencode.v26.GRCh38.genes.gtf")
setwd("/mnt/external/Condensed Graph Model/Version 5.3/Original Dataset")
# Extract Protein-Coding Genes
print('Extracting Protein-Coding Genes')
gencode <- rtracklayer::import("gencode.v26.GRCh38.genes.gtf")
df <- fread(in_file, sep = '\t', header = TRUE)
install.packages('R.utils')
df <- fread(in_file, sep = '\t', header = TRUE)
genes <- fread(gene_file, sep = '\t', header = TRUE)
genes_filtered <- genes[which(paste(genes$gene_name, genes$gene_id) %in% paste(gencode$gene_name, gencode$gene_id)), ]
cov_data <- read.table(cov_file,header = TRUE)
rm(list = ls())
library(data.table)
library(foreach)
library(doParallel)
# ==================================================
# INPUT DATA
cores <- 5
in_file <- 'Muscle_Skeletal_recount normalized.csv'
cov_file <- 'covariates.csv'
gene_file <- 'genes.csv'
out_file <- 'Muscle_Skeletal_recount.csv'
# # ==================================================
df <- read.csv(in_file)
setwd("/mnt/external/Condensed Graph Model/Version 5.3/Replication Analysis 3/Original Dataset/Muscle_Skeletal_recount")
library(data.table)
library(foreach)
library(doParallel)
# INPUT DATA
cores <- 5
in_file <- 'Muscle_Skeletal_recount normalized.csv'
cov_file <- 'covariates.csv'
gene_file <- 'genes.csv'
out_file <- 'Muscle_Skeletal_recount.csv'
df <- read.csv(in_file)
cov_data <- read.csv(cov_file,header = TRUE)
lm_model <- lm( as.numeric(df[i, -1]) ~ cov_data)
i = 1
lm_model <- lm( as.numeric(df[i, -1]) ~ cov_data)
lm_model <- lm( as.numeric(df[i, -1]) ~ t(cov_data))
lm_model <- lm( df[i, -1] ~ t(cov_data[,-1]))
lm_model <- lm( as.numeric(df[i, -1]) ~ cov_data[,-1])
View(cov_data)
df_new <- df[,-1]
cov_new <- cov_data[,-1]
View(df_new)
View(cov_new)
lm_model <- lm( as.numeric(df_new[i, -1]) ~ t(cov_new))
lm_model <- lm( as.numeric(df_new[i, -1]) ~ (cov_new))
class(cov_new)
as.numeric(df_new[i, -1])
df_new <- t(df[,-1])
df_new <- data.frame(t(df[,-1]))
as.numeric(df_new[,i])
lm_model <- lm( as.numeric(df_new[,i]) ~ cov_new)
lm_model <- lm( as.numeric(df[i, -1]) ~ cov_data[,2] + cov_data[,3])
residuals(lm_model)
cluster <- makeCluster(cores)
registerDoParallel(cluster)
df_adjusted <- foreach(i = 1:nrow(df), .combine = 'rbind') %dopar% {
lm_model <- lm( as.numeric(df[i, -1]) ~ cov_data[,2] + cov_data[,3])
residuals(lm_model)
}
stopCluster(cluster)
df_adjusted <- as.data.frame(df_adjusted)
df_adjusted[, 1] <- df[, 1]
library(data.table)
library(foreach)
library(doParallel)
# ==================================================
# INPUT DATA
cores <- 5
in_file <- 'Muscle_Skeletal_recount normalized.csv'
cov_file <- 'covariates.csv'
gene_file <- 'genes.csv'
out_file <- 'Muscle_Skeletal_recount.csv'
# # ==================================================
df <- read.csv(in_file)
cov_data <- read.csv(cov_file,header = TRUE)
# Gene-wise Covariate analysis
cluster <- makeCluster(cores)
registerDoParallel(cluster)
df_adjusted <- foreach(i = 1:nrow(df), .combine = 'rbind') %dopar% {
lm_model <- lm( as.numeric(df[i, -1]) ~ cov_data[,2] + cov_data[,3])
residuals(lm_model)
}
stopCluster(cluster)
df_adjusted <- as.data.frame(df_adjusted)
df_adjusted[, 1] <- cbind(df[, 1, drop = FALSE], df2)
df_adjusted[, 1] <- cbind(df[, 1, drop = FALSE], df_adjusted)
View(df_adjusted)
df_adjusted <- cbind(df[, 1], df_adjusted)
View(df_adjusted)
colnames(df_adjusted)
colnames(df_adjusted) <- colnames(df)
View(df_adjusted)
rm(list = ls())
source("/mnt/external/Condensed Graph Model/Version 5.3/Replication Analysis 3/Original Dataset/Muscle_Skeletal_recount/covariates.R")
rm(list = ls())
source("/mnt/external/Condensed Graph Model/Version 5.3/Replication Analysis 3/Original Dataset/Muscle_Skeletal_recount/covariates.R")
